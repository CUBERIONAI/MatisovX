<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Matisov X | Cyber Samurai</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="https://cdn.tailwindcss.com"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;900&display=swap');

body {
  background:#050505;
  color:white;
  font-family:'Orbitron',sans-serif;
  overflow:hidden;
  user-select:none;
}

.samurai-box{
  position:relative;
  width:100%;
  height:45vh;
  display:flex;
  justify-content:center;
  align-items:center;
}

.aura{
  position:absolute;
  width:220px;
  height:220px;
  background:radial-gradient(circle, rgba(0,210,255,.45) 0%, transparent 70%);
  filter:blur(25px);
  border-radius:50%;
  animation:pulse 2s infinite;
  z-index:1;
}

#samurai{
  height:100%;
  z-index:2;
  transition:transform .08s cubic-bezier(.175,.885,.32,1.275);
  filter:drop-shadow(0 0 12px rgba(0,210,255,.4));
}

.slash{
  transform:scale(1.15) rotate(-6deg) translateY(-10px);
  filter:brightness(1.6) drop-shadow(0 0 35px #00d2ff);
}

@keyframes pulse{
  0%,100%{transform:scale(1);opacity:.5}
  50%{transform:scale(1.3);opacity:.85}
}

.mx-popup{
  position:absolute;
  color:#00d2ff;
  font-weight:900;
  font-size:32px;
  pointer-events:none;
  animation:floatUp .7s forwards;
  z-index:100;
  text-shadow:0 0 10px #00d2ff;
}

@keyframes floatUp{
  0%{transform:translateY(0);opacity:1}
  100%{transform:translateY(-150px);opacity:0}
}

.energy-bar{
  height:12px;
  background:#111;
  border-radius:6px;
  border:1px solid #222;
  overflow:hidden;
}

.energy-fill{
  height:100%;
  background:linear-gradient(90deg,#00d2ff,#0055ff);
  box-shadow:0 0 15px #00d2ff;
  transition:width .2s;
}

.nav-btn.active{
  color:#00d2ff;
  text-shadow:0 0 10px #00d2ff;
}

.screen{display:none;height:calc(100vh - 180px);overflow-y:auto}
.active-screen{display:block}
</style>
</head>

<body class="flex flex-col h-screen p-4">

<audio id="sfx-hit" src="https://assets.mixkit.co/active_storage/sfx/1077/1077-preview.mp3"></audio>

<header class="flex justify-between mb-4">
  <div>
    <p class="text-[10px] text-gray-500 uppercase">Balance</p>
    <div class="flex items-center gap-2">
      <span id="balance" class="text-4xl font-black italic">0</span>
      <span class="text-blue-500 font-bold">MX</span>
    </div>
  </div>
  <div class="text-right">
    <p id="rank" class="text-[10px] text-blue-400 font-bold uppercase">Stage 1</p>
    <p class="text-[8px] text-gray-600 italic">1M MX = 1 Coin</p>
  </div>
</header>

<main class="flex-1">
<section id="game-screen" class="screen active-screen">

<div class="samurai-box" id="tap-target">
  <div class="aura"></div>
  <img id="samurai" src="https://raw.githubusercontent.com/CUBERIONAI/Matisov-X/main/1770305168681.png">
</div>

<div class="mt-8 px-4">
  <div class="flex justify-between text-[10px] mb-2 font-bold text-blue-300">
    <span>‚ö° ENERGY</span>
    <span id="energy-text">1000/1000</span>
  </div>
  <div class="energy-bar">
    <div id="energy-fill" class="energy-fill" style="width:100%"></div>
  </div>
</div>

</section>
</main>

<footer class="h-20 bg-[#0a0a0c] border border-gray-900 rounded-3xl flex justify-around items-center mb-4">
<button onclick="nav('game')" class="nav-btn active flex flex-col items-center">
‚öîÔ∏è<span class="text-[10px] font-bold">FIGHT</span>
</button>
<button onclick="nav('tasks')" class="nav-btn flex flex-col items-center">
üéÅ<span class="text-[10px] font-bold">EARN</span>
</button>
</footer>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

let balance = parseInt(localStorage.getItem('mx_bal')) || 0;
let energy = 1000;
let tapPower = 1;

const samurai = document.getElementById("samurai");
const tapTarget = document.getElementById("tap-target");
const sfxHit = document.getElementById("sfx-hit");

const samuraiFrames = [
 "https://raw.githubusercontent.com/CUBERIONAI/Matisov-X/main/1770305168681.png",
 "https://raw.githubusercontent.com/CUBERIONAI/Matisov-X/main/1770305191748.png",
 "https://raw.githubusercontent.com/CUBERIONAI/Matisov-X/main/1770305210406.png",
 "https://raw.githubusercontent.com/CUBERIONAI/Matisov-X/main/1770305246186.png",
 "https://raw.githubusercontent.com/CUBERIONAI/Matisov-X/main/1770305263574.png"
];

let frameIndex = 0;

// IDLE animation
setInterval(()=>{
 frameIndex = (frameIndex+1)%samuraiFrames.length;
 samurai.src = samuraiFrames[frameIndex];
},500);

tapTarget.addEventListener("touchstart",(e)=>{
 e.preventDefault();
 if(energy<=0) return;

 const t = e.touches[0];
 balance+=tapPower;
 energy-=tapPower;

 frameIndex=(frameIndex+1)%samuraiFrames.length;
 samurai.src=samuraiFrames[frameIndex];

 samurai.classList.add("slash");
 setTimeout(()=>samurai.classList.remove("slash"),80);

 sfxHit.currentTime=0;
 sfxHit.play();

 popup(t.clientX,t.clientY);
 if(tg.HapticFeedback) tg.HapticFeedback.impactOccurred("medium");

 updateUI(); save();
});

function popup(x,y){
 const p=document.createElement("div");
 p.className="mx-popup";
 p.style.left=x+"px"; p.style.top=y+"px";
 p.innerText=`+${tapPower}`;
 document.body.appendChild(p);
 setTimeout(()=>p.remove(),700);
}

function updateUI(){
 balanceEl.innerText=balance.toLocaleString();
 energyText.innerText=`${energy}/1000`;
 energyFill.style.width=(energy/10)+"%";
 rank.innerText=balance>=1e7?"Stage 3 (Shogun)":balance>=1e6?"Stage 2 (Samurai)":"Stage 1";
}

function save(){
 localStorage.setItem("mx_bal",balance);
 localStorage.setItem("mx_time",Date.now());
}

setInterval(()=>{ if(energy<1000){energy+=2;updateUI()} },1000);
updateUI();
</script>

</body>
</html>
