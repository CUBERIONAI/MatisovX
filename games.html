<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Matisov X | Official TWA</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; overflow: hidden; }
        .cyber-aura { border: 2px solid #00d2ff; border-radius: 50%; box-shadow: 0 0 20px rgba(0, 210, 255, 0.4); }
        .energy-bar { background: #1a1a1e; height: 8px; border-radius: 4px; border: 1px solid #333; }
        .energy-fill { background: #00d2ff; height: 100%; transition: width 0.2s; box-shadow: 0 0 10px #00d2ff; }
        .tap-anim { position: absolute; color: #00d2ff; font-weight: 900; pointer-events: none; animation: floatUp 0.8s forwards; z-index: 50; }
        @keyframes floatUp { to { transform: translateY(-100px); opacity: 0; } }
        .screen { display: none; height: calc(100vh - 120px); overflow-y: auto; }
        .active { display: block; }
        .nav-btn { color: #555; transition: 0.3s; }
        .nav-active { color: #00d2ff; }
        /* –ï—Ñ–µ–∫—Ç —ñ—Å–∫—Ä–∏ –ø—Ä–∏ —Ç–∞–ø—ñ */
        .spark { position: absolute; background: #00d2ff; width: 3px; height: 3px; border-radius: 50%; pointer-events: none; animation: spark 0.4s linear forwards; }
        @keyframes spark { to { transform: translate(var(--x), var(--y)); opacity: 0; } }
    </style>
</head>
<body class="flex flex-col h-screen">

    <header class="p-5 flex justify-between items-start">
        <div>
            <p class="text-[10px] text-gray-500 uppercase tracking-widest">Total Balance</p>
            <div class="flex items-center gap-1">
                <span id="balance" class="text-4xl font-bold">0</span>
                <span class="text-blue-500 font-bold">MX</span>
            </div>
        </div>
        <div class="text-right">
            <p id="rank" class="text-[10px] text-blue-400 font-bold uppercase">Ronin (Stage 1)</p>
            <p class="text-[9px] text-gray-600 italic">1,000,000 MX = 1 Coin</p>
        </div>
    </header>

    <main class="flex-1 relative">
        
        <section id="game" class="screen active flex flex-col items-center justify-center p-6">
            <div id="tap-target" class="relative">
                <img id="samurai" src="https://raw.githubusercontent.com/CUBERIONAI/Matisov-X-/ec2f8b52d25750ccb90f4afb2c2666c455b98407/IMG_20260205_104400_997_105248.jpg" 
                     class="w-72 h-72 object-cover cyber-aura active:scale-95 transition-transform duration-75">
            </div>

            <div class="w-full max-w-xs mt-12">
                <div class="flex justify-between text-[10px] mb-2 font-bold tracking-widest">
                    <span>‚ö° ENERGY</span>
                    <span id="energy-text">1000 / 1000</span>
                </div>
                <div class="energy-bar">
                    <div id="energy-fill" class="energy-fill w-full"></div>
                </div>
            </div>
        </section>

        <section id="tasks" class="screen p-6">
            <h2 class="text-xl font-bold mb-6 text-blue-400">Bonus Center</h2>
            <div class="space-y-3" id="tasks-list">
                </div>
        </section>

        <section id="frens" class="screen p-6">
            <h2 class="text-xl font-bold mb-2">Invite Friends</h2>
            <p class="text-xs text-gray-400 mb-6 italic">Earn 20% from friend's activity!</p>
            <div class="bg-[#111] p-6 rounded-2xl border border-gray-800 text-center mb-6">
                <p class="text-xs text-blue-400 mb-4 font-mono truncate">t.me/MatisovX_bot?start=user123</p>
                <button onclick="tg.showAlert('Link Copied!')" class="w-full py-3 bg-blue-600 rounded-xl font-bold text-sm">Copy Invite Link</button>
            </div>
            <div class="grid grid-cols-2 gap-4">
                <div class="bg-black border border-gray-800 p-4 rounded-xl text-center">
                    <p id="fren-count" class="text-2xl font-bold">0</p>
                    <p class="text-[10px] text-gray-500 uppercase">Friends</p>
                </div>
                <div class="bg-black border border-gray-800 p-4 rounded-xl text-center">
                    <p class="text-2xl font-bold text-green-500">20%</p>
                    <p class="text-[10px] text-gray-500 uppercase">Commision</p>
                </div>
            </div>
        </section>
    </main>

    <footer class="h-24 bg-[#0a0a0c] border-t border-gray-900 flex justify-around items-center px-4">
        <button onclick="nav('game')" class="nav-btn nav-active flex flex-col items-center">
            <span class="text-2xl">‚öîÔ∏è</span><span class="text-[10px] font-bold mt-1">GAME</span>
        </button>
        <button onclick="nav('tasks')" class="nav-btn flex flex-col items-center">
            <span class="text-2xl">üéÅ</span><span class="text-[10px] font-bold mt-1">BONUS</span>
        </button>
        <button onclick="nav('frens')" class="nav-btn flex flex-col items-center">
            <span class="text-2xl">üë•</span><span class="text-[10px] font-bold mt-1">FRIENDS</span>
        </button>
    </footer>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // --- GAME STATE ---
        let balance = 0;
        let energy = 1000;
        let tapPower = 1;

        const tasksData = [
            { id: 1, name: "Matisov X Channel", reward: 1000000, link: "https://t.me/Matisov_X" },
            { id: 2, name: "Matisov X Chat", reward: 1000000, link: "https://t.me/MatisovX" },
            { id: 3, name: "YouTube Subscribe", reward: 1000000, link: "https://www.youtube.com/@MatisovX" },
            { id: 4, name: "Instagram Follow", reward: 1000000, link: "https://www.instagram.com/matisov.x" },
            { id: 5, name: "X (Twitter) Follow", reward: 1000000, link: "https://x.com/matisovx" }
        ];

        // --- TAP LOGIC ---
        const target = document.getElementById('tap-target');
        target.addEventListener('touchstart', (e) => {
            e.preventDefault();
            if (energy >= tapPower) {
                const touch = e.touches[0];
                processTap(touch.clientX, touch.clientY);
            }
        });

        function processTap(x, y) {
            balance += tapPower;
            energy -= tapPower;
            
            updateUI();
            createFloatText(x, y);
            createSparks(x, y);
            if(tg.HapticFeedback) tg.HapticFeedback.impactOccurred('medium');
            checkEvolution();
        }

        function updateUI() {
            document.getElementById('balance').innerText = balance.toLocaleString();
            document.getElementById('energy-text').innerText = `${energy} / 1000`;
            document.getElementById('energy-fill').style.width = (energy / 1000 * 100) + '%';
        }

        function createFloatText(x, y) {
            const t = document.createElement('div');
            t.className = 'tap-anim';
            t.style.left = x + 'px'; t.style.top = y + 'px';
            t.innerText = `+${tapPower}`;
            document.body.appendChild(t);
            setTimeout(() => t.remove(), 800);
        }

        function createSparks(x, y) {
            for(let i=0; i<6; i++) {
                const s = document.createElement('div');
                s.className = 'spark';
                s.style.left = x + 'px'; s.style.top = y + 'px';
                s.style.setProperty('--x', (Math.random()*80 - 40)+'px');
                s.style.setProperty('--y', (Math.random()*80 - 40)+'px');
                document.body.appendChild(s);
                setTimeout(() => s.remove(), 400);
            }
        }

        // --- NAVIGATION & TASKS ---
        function nav(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('nav-active'));
            event.currentTarget.classList.add('nav-active');
        }

        function initTasks() {
            const list = document.getElementById('tasks-list');
            tasksData.forEach(t => {
                list.innerHTML += `
                    <div class="bg-[#111] p-4 rounded-xl border border-gray-800 flex justify-between items-center">
                        <div><p class="font-bold text-sm">${t.name}</p><p class="text-xs text-blue-400">+1,000,000 MX</p></div>
                        <button onclick="claimTask('${t.link}', ${t.reward})" class="bg-blue-600 px-4 py-1 rounded-lg text-xs font-bold uppercase">Go</button>
                    </div>`;
            });
        }

        function claimTask(url, reward) {
            window.open(url, '_blank');
            setTimeout(() => {
                balance += reward;
                updateUI();
                tg.showAlert(`Successfully earned ${reward.toLocaleString()} MX!`);
            }, 3000);
        }

        function checkEvolution() {
            const sam = document.getElementById('samurai');
            const rank = document.getElementById('rank');
            if(balance >= 10000000) {
                sam.style.boxShadow = "0 0 50px #ff00ea"; sam.style.borderColor = "#ff00ea";
                rank.innerText = "Shogun (Stage 3)";
            } else if(balance >= 1000000) {
                sam.style.boxShadow = "0 0 30px #00d2ff";
                rank.innerText = "Cyber Samurai (Stage 2)";
            }
        }

        // Energy Regeneration
        setInterval(() => {
            if(energy < 1000) { energy = Math.min(1000, energy + 2); updateUI(); }
        }, 1000);

        initTasks();
    </script>
</body>
</html>
